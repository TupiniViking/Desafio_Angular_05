"use strict";(self.webpackChunkdesafio_angular=self.webpackChunkdesafio_angular||[]).push([[939],{5939:(me,_,o)=>{o.r(_),o.d(_,{DashboardModule:()=>pe});var d=o(9808),C=o(8759),e=o(4893),m=o(4004);function b(...n){const a=n.length;if(0===a)throw new Error("list of properties cannot be empty.");return(0,m.U)(t=>{let i=t;for(let s=0;s<a;s++){const l=null==i?void 0:i[n[s]];if(void 0===l)return;i=l}return i})}var M=o(2340),w=o(520);const y=M.N.apiURL;let T=(()=>{class n{constructor(t){this.http=t}getVehicles(){return this.http.get(`${y}/vehicle`).pipe(b("vehicles"))}getVehiclesData(t){return this.http.get(`${y}/vehicleData`).pipe(b("vehicleData"),(0,m.U)(i=>t?i.filter(s=>{var l;return null===(l=s.vin)||void 0===l?void 0:l.includes(t)}):i))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(w.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var r=o(2382);function A(n,a){if(1&n&&(e.TgZ(0,"option",11),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.vehicle),e.xp6(1),e.hij(" ",t.vehicle," ")}}function S(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"option",9),e._uU(2,"-"),e.qZA(),e.YNc(3,A,2,2,"option",10),e.BQk()),2&n){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("ngForOf",t.vehicles)}}function Z(n,a){if(1&n&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw().ngIf;e.xp6(1),e.hij(" ",t.callback(i.vehicles)," ")}}function P(n,a){1&n&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2,"\xa0"),e.qZA()())}function U(n,a){if(1&n&&(e.TgZ(0,"div")(1,"div",3)(2,"div",4),e._uU(3),e.qZA(),e.TgZ(4,"div",5),e.YNc(5,Z,2,1,"div",12),e.YNc(6,P,3,0,"ng-template",null,13,e.W1O),e.TgZ(8,"small",14),e._uU(9,"Unid."),e.qZA()()()()),2&n){const t=a.$implicit,i=e.MAs(7),s=e.oxw().ngIf;e.xp6(3),e.Oqu(t.header),e.xp6(2),e.Q6J("ngIf",!!s.vehicles)("ngIfElse",i)}}function F(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),e._uU(4,"Ve\xedculo"),e.qZA(),e.TgZ(5,"div",5)(6,"select",6),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().selectedVehicle=s})("change",function(){e.CHM(t);const s=e.oxw();return s.selectVehicleEvent.emit(s.selectedVehicle)}),e.YNc(7,S,4,1,"ng-container",7),e.qZA()()(),e.YNc(8,U,10,3,"div",8),e.qZA()()}if(2&n){const t=a.ngIf,i=e.oxw();e.xp6(6),e.Q6J("disabled",!t.vehicles)("ngModel",i.selectedVehicle),e.xp6(1),e.Q6J("ngIf",!!t.vehicles),e.xp6(1),e.Q6J("ngForOf",i.dataCards)}}const E=function(n){return{vehicles:n}};let N=(()=>{class n{constructor(t){this.vehiclesService=t,this.dataCards=[{header:"Total de Vendas",callback:this.getTotalSales.bind(this)},{header:"Conectados",callback:this.getConnected.bind(this)},{header:"Update Software",callback:this.getSoftwareUpdate.bind(this)}],this.selectVehicleEvent=new e.vpe,this.selectedVehicle="-",this.vehicles$=this.vehiclesService.getVehicles()}getConnected(t){var i,s;return null!==(s=null===(i=this.findSelectedVehicle(t))||void 0===i?void 0:i.connected)&&void 0!==s?s:"-"}getSoftwareUpdate(t){var i,s;return null!==(s=null===(i=this.findSelectedVehicle(t))||void 0===i?void 0:i.softwareUpdates)&&void 0!==s?s:"-"}getTotalSales(t){var i,s;return null!==(s=null===(i=this.findSelectedVehicle(t))||void 0===i?void 0:i.volumetotal)&&void 0!==s?s:"-"}findSelectedVehicle(t){return t.find(i=>i.vehicle===this.selectedVehicle)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-data-cards"]],outputs:{selectVehicleEvent:"selectVehicleEvent"},decls:2,vars:5,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"d-flex","flex-wrap","gap-2","align-items-stretch","justify-content-center","justify-content-md-between"],[1,"card"],[1,"card-header","fs-5"],[1,"card-body"],[1,"form-select","form-select-lg",3,"disabled","ngModel","ngModelChange","change"],[4,"ngIf"],[4,"ngFor","ngForOf"],["disabled","","selected","","value","-"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","fs-5 text-primary fw-bold",4,"ngIf","ngIfElse"],["placeholder",""],[1,"text-black-50"],[1,"fs-5","text-primary","fw-bold"],[1,"placeholder-glow"],[1,"placeholder","col-2","bg-primary"]],template:function(t,i){1&t&&(e.YNc(0,F,9,4,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.VKq(3,E,e.lcZ(1,1,i.vehicles$)))},directives:[d.O5,r.EJ,r.JJ,r.On,r.YN,r.Kr,d.sg],pipes:[d.Ov],styles:[".card[_ngcontent-%COMP%]{width:14rem;min-height:9rem}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}"]}),n})();var c=o(1777);let J=(()=>{class n{constructor(){this._previousImgAlt="",this._previousImgUrl="",this.hasImgLeft=!1,this.hasSelectionChanged=!1,this.selectedVehicle=""}get vehicleImgAlt(){if(this.hasSelectionChanged)return this._previousImgAlt;const t=this.selectedVehicle;return this._previousImgAlt=t,t}get vehicleImgUrl(){if(this.hasSelectionChanged)return this._previousImgUrl;const t=""!==this.selectedVehicle?`assets/img/${this.selectedVehicle.replace(/\s/g,"")}.png`:"";return this._previousImgUrl=t,t}afterArrive(){this.hasImgLeft=!1,this.hasSelectionChanged=!1}afterLeave(){this.hasImgLeft=!0}ngOnChanges(t){t.selectedVehicle&&(this.hasSelectionChanged=!0)}triggerArrive(){return this.hasImgLeft&&this.hasSelectionChanged}triggerLeave(){return!this.hasImgLeft&&this.hasSelectionChanged}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-car-image"]],inputs:{selectedVehicle:"selectedVehicle"},features:[e.TTD],decls:1,vars:4,consts:[[1,"car-picture","img-fluid","w-50","d-block","mx-auto","mt-2",3,"src","alt"]],template:function(t,i){1&t&&(e.TgZ(0,"img",0),e.NdJ("@imageLeave.done",function(){return i.afterLeave()})("@imageArrive.done",function(){return i.afterArrive()}),e.qZA()),2&t&&e.Q6J("@imageLeave",i.triggerLeave())("@imageArrive",i.triggerArrive())("src",i.vehicleImgUrl,e.LSH)("alt",i.vehicleImgAlt)},styles:[""],data:{animation:[(0,c.X$)("imageLeave",[(0,c.SB)("true",(0,c.oB)({transform:"translateX(10%)",opacity:0})),(0,c.SB)("false",(0,c.oB)({transform:"translateX(0)",opacity:1})),(0,c.eR)("false => true",(0,c.jt)(150))]),(0,c.X$)("imageArrive",[(0,c.SB)("true",(0,c.oB)({transform:"translateX(-10%)",opacity:0})),(0,c.SB)("false",(0,c.oB)({transform:"translateX(0)",opacity:1})),(0,c.eR)("true => false",(0,c.jt)(150))])]}}),n})();var D=o(727);class L extends D.w0{constructor(a,t){super()}schedule(a,t=0){return this}}const f={setInterval(n,a,...t){const{delegate:i}=f;return(null==i?void 0:i.setInterval)?i.setInterval(n,a,...t):setInterval(n,a,...t)},clearInterval(n){const{delegate:a}=f;return((null==a?void 0:a.clearInterval)||clearInterval)(n)},delegate:void 0};var Q=o(8737);const x={now:()=>(x.delegate||Date).now(),delegate:void 0};class u{constructor(a,t=u.now){this.schedulerActionCtor=a,this.now=t}schedule(a,t=0,i){return new this.schedulerActionCtor(this,a).schedule(i,t)}}u.now=x.now;const B=new class Y extends u{constructor(a,t=u.now){super(a,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(a){const{actions:t}=this;if(this._active)return void t.push(a);let i;this._active=!0;do{if(i=a.execute(a.state,a.delay))break}while(a=t.shift());if(this._active=!1,i){for(;a=t.shift();)a.unsubscribe();throw i}}}(class $ extends L{constructor(a,t){super(a,t),this.scheduler=a,this.work=t,this.pending=!1}schedule(a,t=0){if(this.closed)return this;this.state=a;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this}requestAsyncId(a,t,i=0){return f.setInterval(a.flush.bind(a,this),i)}recycleAsyncId(a,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;f.clearInterval(t)}execute(a,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(a,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(a,t){let s,i=!1;try{this.work(a)}catch(l){i=!0,s=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:a,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Q.P)(i,this),null!=a&&(this.id=this.recycleAsyncId(t,a,null)),this.delay=null,super.unsubscribe()}}});var I=o(4482),V=o(5403),v=o(8505),X=o(4671);function R(n,a){return n===a}var k=o(3900),H=o(6451);const K=["vinInput"];function W(n,a){if(1&n&&(e.TgZ(0,"th",8),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.header," ")}}function z(n,a){if(1&n&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.vin," ")}}function G(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"input",12,13),e.TgZ(3,"datalist",14),e.YNc(4,z,2,1,"option",15),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).ngIf,i=e.oxw();e.xp6(1),e.Q6J("formControl",i.searchedVin),e.xp6(3),e.Q6J("ngForOf",t.vehiclesData)}}function ee(n,a){if(1&n&&(e.TgZ(0,"span",19),e._uU(1),e.qZA()),2&n){const t=e.oxw(3).$implicit,i=e.oxw().ngIf,s=e.oxw();let l;e.xp6(1),e.hij(" ",s.getDataFromVehicle(t.data,i.vehiclesData).concat(null!==(l=t.unit)&&void 0!==l?l:""),"")}}function te(n,a){1&n&&e._UZ(0,"span",20),2&n&&e.Q6J("@delaySpinner",void 0)}function ne(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ee,2,1,"span",17),e.YNc(2,te,1,1,"ng-template",null,18,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",!i.isLoadingTableData)("ngIfElse",t)}}function ie(n,a){1&n&&(e.TgZ(0,"div",21)(1,"span",22),e._uU(2,"\xa0"),e.qZA()())}function ae(n,a){if(1&n&&(e.YNc(0,ne,4,2,"ng-container",10),e.YNc(1,ie,3,0,"ng-template",null,16,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw(2).ngIf;e.Q6J("ngIf",i.vehiclesData)("ngIfElse",t)}}function se(n,a){if(1&n&&(e.TgZ(0,"td",9),e.YNc(1,G,5,2,"ng-container",10),e.YNc(2,ae,3,2,"ng-template",null,11,e.W1O),e.qZA()),2&n){const t=a.$implicit,i=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!t.data)("ngIfElse",i)}}function le(n,a){if(1&n&&(e.TgZ(0,"div")(1,"div",1)(2,"table",2)(3,"thead")(4,"tr",3),e.YNc(5,W,2,1,"th",4),e.qZA()(),e.TgZ(6,"tbody")(7,"tr",5),e.YNc(8,se,4,2,"td",6),e.qZA()(),e.TgZ(9,"tfoot")(10,"tr"),e._UZ(11,"td",7),e.qZA()()()()()),2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.tableFields),e.xp6(3),e.Q6J("ngForOf",t.tableFields)}}const oe=function(n){return{vehiclesData:n}};let de=(()=>{class n{constructor(t){this.vehiclesService=t,this._allVehiclesDataSub=new D.w0,this._hasVinMatched=!1,this._isTableDataOnScreen=!1,this.isLoadingTableData=!1,this.searchedVin=new r.NI({value:"",disabled:!0},r.kI.required),this.allVehiclesData$=this.vehiclesService.getVehiclesData(),this.filteredVehiclesData$=this.searchedVin.valueChanges.pipe(function j(n,a=B){return(0,I.e)((t,i)=>{let s=null,l=null,g=null;const p=()=>{if(s){s.unsubscribe(),s=null;const h=l;l=null,i.next(h)}};function fe(){const h=g+n,O=a.now();if(O<h)return s=this.schedule(void 0,h-O),void i.add(s);p()}t.subscribe((0,V.x)(i,h=>{l=h,g=a.now(),s||(s=a.schedule(fe,n),i.add(s))},()=>{p(),i.complete()},void 0,()=>{l=s=null}))})}(200),(0,m.U)(i=>{const s=i.toUpperCase();return this.searchedVin.setValue(s,{emitEvent:!1}),s}),(0,v.b)(i=>{this._hasVinMatched=20===i.length&&this.vinMatchVehicleData(i),this._hasVinMatched&&this.vinInputElement&&this.vinInputElement.nativeElement.blur(),this.isLoadingTableData=this._hasVinMatched&&!this._isTableDataOnScreen||!this._hasVinMatched&&this._isTableDataOnScreen}),function q(n,a=X.y){return n=null!=n?n:R,(0,I.e)((t,i)=>{let s,l=!0;t.subscribe((0,V.x)(i,g=>{const p=a(g);(l||!n(s,p))&&(l=!1,s=p,i.next(g))}))})}(),(0,k.w)(i=>this.vehiclesService.getVehiclesData(i)),(0,v.b)(()=>{this.isLoadingTableData&&(this._isTableDataOnScreen=this._hasVinMatched),this.isLoadingTableData=!1})),this.tableFields=[{header:"C\xf3digo - Vin"},{header:"Od\xf4metro",data:"odometer",unit:" km"},{header:"N\xedvel de Combust\xedvel",data:"fuelLevel",unit:" %"},{header:"Status",data:"status"},{header:"Lat.",data:"lat"},{header:"Long.",data:"long"}],this.vehiclesData$=(0,H.T)(this.allVehiclesData$,this.filteredVehiclesData$).pipe((0,v.b)(()=>this.searchedVin.enable({onlySelf:!0,emitEvent:!1})))}getDataFromVehicle(t,i){return t&&1===i.length?i[0][t].toString():"-"}ngOnDestroy(){this._allVehiclesDataSub.unsubscribe()}ngOnInit(){this._allVehiclesDataSub=this.allVehiclesData$.subscribe(t=>this._allVehiclesData=t)}vinMatchVehicleData(t){var i;return!!(null===(i=this._allVehiclesData)||void 0===i?void 0:i.find(s=>s.vin.toUpperCase()===t.toUpperCase()))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-data-table"]],viewQuery:function(t,i){if(1&t&&e.Gf(K,5),2&t){let s;e.iGM(s=e.CRH())&&(i.vinInputElement=s.first)}},decls:2,vars:5,consts:[[4,"ngIf"],[1,"table-responsive"],[1,"mb-0"],[1,"d-flex","bg-primary","text-white"],["class","col","scope","col",4,"ngFor","ngForOf"],[1,"d-flex","pt-1","pb-1"],["class","col",4,"ngFor","ngForOf"],["colspan","100%",1,"bg-primary"],["scope","col",1,"col"],[1,"col"],[4,"ngIf","ngIfElse"],["dataCol",""],["list","dataVehicles","type","text",1,"form-control-sm",3,"formControl"],["vinInput",""],["id","dataVehicles"],[4,"ngFor","ngForOf"],["placeholder",""],["class","fw-bold",4,"ngIf","ngIfElse"],["spinnerBlock",""],[1,"fw-bold"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"placeholder-glow"],[1,"placeholder","col-2"]],template:function(t,i){1&t&&(e.YNc(0,le,12,2,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.VKq(3,oe,e.lcZ(1,1,i.vehiclesData$)))},directives:[d.O5,d.sg,r.Fj,r.JJ,r.oH,r.YN,r.Kr],pipes:[d.Ov],styles:["table[_ngcontent-%COMP%]{width:100%;min-height:5em;max-width:100%;color:#212529;border-color:#dee2e6}table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:75%!important}table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background-color:#ddd}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border:none}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-inline:1px solid #ccc;align-self:stretch;padding-inline:1em;display:grid;align-items:center;min-height:3rem;min-width:7rem}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{flex-grow:1.5!important}table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{height:.5em}"],data:{animation:[(0,c.X$)("delaySpinner",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0}),(0,c.jt)("250ms 250ms",(0,c.oB)({opacity:1}))])])]}}),n})();const he=[{path:"",component:(()=>{class n{constructor(){this.selectedVehicle=""}selectVehicle(t){this.selectedVehicle=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dashboard"]],decls:6,vars:1,consts:[[1,"viewport-center","d-flex","flex-column","align-items-between"],[1,"text-primary","display-4","text-center","mb-4"],[3,"selectVehicleEvent"],[3,"selectedVehicle"],[1,"position-fixed","bottom-0","start-0","end-0","bg-white"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Dashboard FORD"),e.qZA(),e.TgZ(3,"app-data-cards",2),e.NdJ("selectVehicleEvent",function(l){return i.selectVehicle(l)}),e.qZA(),e._UZ(4,"app-car-image",3)(5,"app-data-table",4),e.qZA()),2&t&&(e.xp6(4),e.Q6J("selectedVehicle",i.selectedVehicle))},directives:[N,J,de],styles:[".viewport-center[_ngcontent-%COMP%]{min-height:90vh;position:relative;padding-bottom:108px}"]}),n})()}];let ue=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[C.Bz.forChild(he)],C.Bz]}),n})();var ge=o(4466);let pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[d.ez,ue,ge.m,r.u5,r.UX]]}),n})()}}]);